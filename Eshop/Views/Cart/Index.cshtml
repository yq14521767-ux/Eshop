@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@

@model Eshop.Models.Cart

@{
	ViewData["Title"] = "è´­ç‰©è½¦";
}

<div class="page-header">
	<h2 class="m-0">ğŸ›’ æˆ‘çš„è´­ç‰©è½¦</h2>
</div>

@if (TempData["Error"] != null)
{
	<div class="alert alert-warning">
		@TempData["Error"]
	</div>
}

@if (Model.CartItems.Count == 0)
{
	<div class="alert alert-info">è´­ç‰©è½¦æ˜¯ç©ºçš„ï¼Œ<a class="alert-link" asp-controller="Products" asp-action="Index">å»æŒ‘å‡ ä»¶å•†å“å§ â†’</a></div>
}
else
{
	<table class="table table-hover table-bordered align-middle">
		<thead>
			<tr>
				<th>å•†å“</th>
				<th>å•ä»·</th>
				<th>æ•°é‡</th>
				<th>å°è®¡</th>
				<th>æ“ä½œ</th>
			</tr>
		</thead>

		<tbody>
			@foreach (var item in Model.CartItems)
			{
				<tr>
					<td>@item.Product?.Name</td>
					<td>@(item.Product != null ? item.Product.Price.ToString("F2") : "0.00")</td>
					<td>@item.Quantity</td>
					<td>@(item.Product != null ? (item.Quantity * item.Product.Price).ToString("F2") : "0.00")</td>
					<td>
						<div class="table-actions">
							<a asp-action="RemoveFromCart" asp-route-itemId="@item.Id" class="btn btn-danger btn-sm">åˆ é™¤</a>
						</div>
					</td>
				</tr>
			}
		</tbody>
	</table>

	<div class="d-flex justify-content-between align-items-center">
		<div>
			<a asp-controller="Products" asp-action="Index" class="btn btn-secondary">ç»§ç»­è´­ç‰©</a>
		</div>

		<div>
			@{
				var total = Model.CartItems.Sum(ci => (ci.Product != null ? ci.Product.Price * ci.Quantity : 0m));
			}
			<strong class="me-3">æ€»è®¡ï¼šÂ¥@total.ToString("F2")</strong>
			<form asp-controller="Orders" asp-action="Create" method="post" class="d-inline-block">
				@Html.AntiForgeryToken()
				<button type="submit" class="btn btn-success btn-sm">ç»“ç®—</button>
			</form>
		</div>
	</div>

}
